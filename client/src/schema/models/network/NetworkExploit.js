import { Model, attr, fk } from 'redux-orm'

class NetworkExploit extends Model {
  toString () {
    return `NetworkExploit: ${this.id}`
  }
}
NetworkExploit.modelName = 'NetworkExploit'
NetworkExploit.fields = {
  id: attr(),
  type: attr(),
  networkStep: fk({
    to: 'NetworkStep',
    relatedName: 'networkExploits'
  }),
  networkVulnerability: fk({
    to: 'NetworkVulnerability',
    relatedName: 'networkExploits'
  }),
  ifaceSource: fk({
    to: 'Iface',
    relatedName: 'networkExploitsOutgoing'
  }),
  ifaceTarget: fk({
    to: 'Iface',
    relatedName: 'networkExploitsIncoming'
  }),
  networkServiceTarget: fk({
    to: 'NetworkService',
    relatedName: 'networkExploitsIncoming'
  })
}

export default NetworkExploit
